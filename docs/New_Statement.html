<!DOCTYPE HTML>
<html lang="en-US" dir="ltr">
<head>
<meta charset="utf-8">
<title>New Statement - The ViviFire Programming Language</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="common.css" type="text/css">
<link rel="canonical" href="https://www.b6sw.com/ViviFire/docs/New_Statement.html">
<link rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/">
<meta name="author" content="Brent Thorn">
</head>
<body>
<nav class="breadcrumb" aria-labelledby="breadcrumbs">
<p id="breadcrumbs">Breadcrumbs</p>
<ul>
<li><a href="http://vivifire.com/">Home</a></li>
<li><a href="ViviFire_Manual.html">ViviFire Manual</a></li>
<li><a rel="section" href="Language_Reference.html">Language Reference</a></li>
<li><a href="Statements_Reference.html">Statements</a></li>
<li><a rel="parent" href="Statements_2.html">F&ndash;P Statements</a></li>
</ul>
</nav>
<main>
<h1 id="top">New Statement</h1>
<p>Makes an instance of an object and initializes it.</p>
<h2>Syntax</h2>
<div class="language-vivifire syntax">
<pre><code>[ @Shared ] [ New ] class_name object_name [ , argument_list ]
[ Begin [ default_type  |  Call method_name [ initializer ] ]
    [ statements ]
End [ New | class_name ] ]&#10;</code></pre>
</div>
<h2>Parts</h2>
<dl class="parts">
<dt><code class="at">@Shared</code></dt>
<dd>Optional &ndash; There can be only one instance for all classes or procedure calls.</dd>
<dt><code class="kw">New</code></dt>
<dd>Usually optional keyword.</dd>
<dd>Mandatory if the statement is a nested member of <code class="kw">New</code>.</dd>
<dt><code class="id">class_name</code></dt>
<dd>Mandatory name of a class.</dd>
<dt><code class="id">object_name</code></dt>
<dd>Mandatory name for the object.</dd>
<dt><code class="id">argument_list</code></dt>
<dd>Optional &ndash; One or more expressions with a comma between each.</dd>
<dt><code class="kw">Begin</code></dt>
<dd>Optional &ndash; Starts the block construct.</dd>
<dt><code class="id">default_type</code></dt>
<dd>Optional data type that the compiler will use for the subsequent statements, if the data type is not specified.
The data type must be related to the type specified in a constructor of <code class="id">class_name</code>.</dd>
<dt><code class="id">method_name</code></dt>
<dd>Optional name of the method to call for each <code class="id">initializer</code> or <code class="id">statement</code>.
It must come after the keyword <code class="kw">Call</code>.</dd>
<dt><code class="id">initializer</code></dt>
<dd>Optional on the same line after <code class="id">method_name</code>.
It must be a list of values with a comma between each, all between braces (<code class="op">{ }</code>).</dd>
<dt><code class="id">statements</code></dt>
<dd>Mandatory in the block construct and if there is no initializer, one or more object-creation statements.
See the section &ldquo;<a href="#Permitted_members">Permitted members</a>&rdquo; for more information.</dd>
<dt><code class="kw">End</code></dt>
<dd>Completes the block construct.
You can also use one of <code class="kw">End New</code> or <code class="kw">End</code>&nbsp;<code class="id">class_name</code>.</dd>
</dl>
<h2>Instructions</h2>
<h3 id="Permitted_members">Permitted members</h3>
<ul>
<li><code class="kw">New</code></li>
<li><code class="kw">Object</code></li>
<li>an argument list, which is seen as the arguments to <code class="kw">New</code></li>
</ul>
<h3>Changes in syntax with @Option</h3>
<p>There are two areas where you can change the syntax of the statement:</p>
<ul>
<li><code>@Option New</code></li>
<li><code>@Option End Block</code> and <code>@Option End</code></li>
</ul>
<p>See <a href="Option_Directive.html">@Option Directive</a> for more information.</p>
<h2>Examples</h2>
<h3>One-line constructs</h3>
<div class="language-vivifire listing">
<pre><code>' Find all text files in the current directory.
Files txtFiles, "*.txt"

For Each file In txtFiles
    PrintLine file.Name
End For&#10;</code></pre>
</div>
<h3>One-line construct compared to the block construct</h3>
<p>First we make a menu with a one-line statement.
It shows &ldquo;File&rdquo; on the menu bar.
In the related popup menu, it shows two commands: &ldquo;Open&hellip;&rdquo; and &ldquo;Exit&rdquo.
Between these two items we write a vertical bar, which shows as a separator.
This symbol is an alternative to <code class="kw">#Null</code> that you can use only in argument lists.
If you select one of the commands, then it calls the related procedure.</p>
<div class="language-vivifire listing">
<pre><code>' Make a menu.
Menu FileMenu, "&File", "&amp;Open...", DoOpen, |, "E&amp;xit", DoExit&#10;</code></pre>
</div>
<hr>
<p>Then we re-write the example as a block construct.
It starts the same as before, until we get to the first command.
Before the commands, we must write the keyword Begin on one line.
Then we write each item on separate lines.
The vertical bar permits hyphens without limit.
Then we write <code class="kw">End New</code> to complete the statement.</p>
<div class="language-vivifire listing">
<pre><code>New Menu FileMenu, "&amp;File"
Begin
    "&amp;Open...", DoOpen
    |----
    "E&amp;xit", DoExit
End New&#10;</code></pre>
</div>
<hr>
<p>In the next example, we add a sub-menu to the menu with the text &ldquo;New&rdquo;.
The sub-menu has two commands: &ldquo;File&rdquo; and &ldquo;Folder&rdquo;.
We cannot add a sub-menu to the one-line construct.
But the block construct does not have this limit.</p>
<div class="language-vivifire listing">
<pre><code>Menu FileMenu, "&amp;File"
Begin
    New menu newMenu, "&New"
    Begin
        "&File", DoNewFile
        "Fol&der", DoNewFolder
    End Menu
    "&amp;Open...", DoOpen
    |----
    "E&amp;xit", DoExit
End Menu&#10;</code></pre>
</div>
<h3>Call construct</h3>
<p>In this example, we declare a list of strings and add some items.
The class <code>List</code> has a method (<code>Add</code>) to add one item at a time.
We write <code>Add</code> after <code class="kw">Begin Call</code> to give the method to call for each item in an array.
We supply the items in an array initializer.
The initializer must be on the same line that starts with Begin.
We can use the automatic line continuation of braces and commas to make the code easier to read.</p>
<div class="language-vivifire listing">
<pre><code>List[String] fruits
Begin Call Add {
    "apple", "banana", "cherry",
    "peach", "pear", "pineapple"
}
End&#10;</code></pre>
</div>
<h2>See also</h2>
<ul class="articles">
<li><a href="Dim_Statement.html">Dim Statement</a></li>
<li><a href="Object_Statement.html">Object Statement</a></li>
<li><a href="Default_Values.html">Default Values</a></li>
<li><a href="Option_Directive.html">@Option Directive</a></li>
</ul>
</main>
<script src="common.js"></script>
<script src="prism.js"></script>
</body>
</html>
