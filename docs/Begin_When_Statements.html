<!DOCTYPE HTML>
<html lang="en-US" dir="ltr">
<head>
<meta charset="utf-8">
<title>Begin&hellip;When Statements - The ViviFire Programming Language</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="With the ViviFire programming language, the Begin&hellip;When statements execute a block of code given how a loop exits.">
<link rel="stylesheet" href="common.css" type="text/css">
<link rel="canonical" href="https://www.b6sw.com/ViviFire/docs/Begin_When_Statements.html">
<link rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/">
<meta name="author" content="Brent Thorn">
</head>
<body>
<nav class="breadcrumb" aria-labelledby="breadcrumbs">
<p id="breadcrumbs">Breadcrumbs</p>
<ul>
<li><a href="http://vivifire.com/">Home</a></li>
<li><a href="ViviFire_Manual.html">ViviFire Manual</a></li>
<li><a rel="section" href="Language_Reference.html">Language Reference</a></li>
<li><a href="Statements_Reference.html">Statements</a></li>
<li><a href="Clauses.html">Clauses</a></li>
</ul>
</nav>
<main>
<h1 id="top">Begin&hellip;When Statements</h1>
<p>Execute a different block of code given what the loop does.</p>
<h2>Syntax</h2>
<div class="language-vivifire syntax">
<pre><code>start_clause
  Begin [ identifier_list ]
    [ loop_statements ]
  When { identifier | %NONE | %DONE | Else }
    [ after_statements ]
  &hellip;
end_clause&#10;</code></pre>
</div>
<h2>Parts</h2>
<dl class="parts">
<dt><code class="id">start_clause</code></dt>
<dd>Mandatory start clause for one of the loop constructs:
<span class="kws"><code>Do</code>, <code>For</code>, <code>For Each</code>, or <code>While</code></span>.</dd>
<dt><code class="kw">Begin</code></dt>
<dd>Mandatory keyword.</dd>
<dt><code class="id">identifier_list</code></dt>
<dd>Optional one or more identifiers with a comma between each.</dd>
<dt><code class="id">loop_statements</code></dt>
<dd>Optional statements that execute again and again.</dd>
<dt><code class="kw">When</code></dt>
<dd>Mandatory one or more times</dd>
<dt><code class="id">identifier</code></dt>
<dd>Mandatory for each identifier in <code class="id">identifier_list</code>.
Specifies the start of statements that execute after &ldquo;<code>Exit identifier</code>&rdquo;.</dd>
<dt><code class="num">%NONE</code></dt>
<dd>Specifies the start of statements that execute when <code class="id">loop_statements</code> did not execute.</dd>
<dt><code class="num">%DONE</code></dt>
<dd>Specifies the start of statements that execute when <code class="id">loop_statements</code> completed.</dd>
<dt><code class="kw">Else</code></dt>
<dd>Specifies the start of statements that execute when one of the conditions, <code class="num">%NONE</code> or <code class="num">%DONE</code>, are true.
If you use <code class="kw">Else</code>, then you cannot use <code>%NONE</code> or <code>%DONE</code>.</dd>
<dt><code class="id">after_statements</code></dt>
<dd>Optional executable statements.</dd>
<dt><code class="id">end_clause</code></dt>
<dd>Mandatory end clause for its related start clause (<code class="id">start_clause</code>).</dd>
</dl>
<h2>Instructions</h2>
<h3>When identifier</h3>
<p>If you use <code>When identifier</code> in a loop construct, then the statements in this block of code execute because of <code>Exit identifier</code>.</p>
<h3>When %DONE</h3>
<p>If you use <code>When %DONE</code> in a loop construct, then the statements in this block of code execute only when the loop stops as usual.
The statements execute at most one time for each loop, almost the same as code not in the loop.</p>
<p>If a loop stops because of <code class="kw">Exit</code> or <code class="kw">Return</code>, then <code>When %DONE</code> does not execute.
Thus execution continues as usual for the given statement.</p>
<h3>When %NONE</h3>
<p>If you use <code>When %NONE</code>, then the statements in this block of code execute only when the body of the loop did not execute.
A table that summarizes the conditions in which this can occur follows.</p>
<style media="all and (max-width: 40em)">
#twn td:nth-of-type(1):before { content: "Loop construct"; }
#twn td:nth-of-type(2):before { content: "Loop body not executed"; }
</style>
<table id="twn" class="wide language-vivifire syntax">
<thead>
<tr><th>Loop construct</th><th>Loop body not executed</th></tr>
</thead>
<tbody>
<tr><td><pre><code>While C</code></pre></td>
<td>When condition <var>C</var> is initially false</td></tr>
<tr><td><pre><code>Do While C</code></pre></td>
<td>When condition <var>C</var> is initially false</td></tr>
<tr><td><pre><code>Do Until C</code></pre></td>
<td>When condition <var>C</var> is initially true</td></tr>
<tr><td><pre><code>For I = A To B [ Step D ]</code></pre></td>
<td>When <var>A</var>&nbsp;&gt;&nbsp;<var>B</var> for a positive <var>D</var>.
Or <var>A</var>&nbsp;&lt;&nbsp;<var>B</var> for a negative <var>D</var></td></tr>
<tr><td><pre><code>For Each I In G</code></pre></td>
<td>When group <var>G</var> is <code class="kw">#Null</code> or is empty</td></tr>
</tbody>
</table>
<p class="note">Note: You cannot use <code>When %NONE</code> in <code class="kw">Do&hellip;Loop While</code> and <code class="kw">Do&hellip;Loop Until</code> because they execute their statements a minimum of one time.</p>
<h3>When Else</h3>
<p>If you use <code class="kw">When Else</code> in a loop, then it is the same as <code>When %DONE</code> and <code>When %NONE</code> put together.</p>
<h3>Scope</h3>
<p>The scope of variables in these blocks is the same as variables in the usual loop construct.
Thus you cannot use variables declared in them after the end of the loop.</p>
<h2>Examples</h2>
<h3>When identifier</h3>
<div class="language-vivifire listing">
<pre><code>For Each name$ In names$()
  Begin found
    If name$ = match$ Then Exit found
  When found
    PrintLine "Match found."
  When %DONE
    PrintLine "No matches found."
End For&#10;</code></pre>
</div>
<!--
<div class="language-vivifire listing">
<pre><code>While #inp.Read(data$)
  Begin
    Call ProcessData data$
  When %DONE
    
End While&#10;</code></pre>
</div>
-->
<h2>See also</h2>
<ul class="articles">
<li><a href="Do_Loop_Statement.html">Do&hellip;Loop Statement</a></li>
<li><a href="Exit_Statement.html">Exit Statement</a></li>
<li><a href="For_To_Statement.html">For Statement</a></li>
<li><a href="For_Each_In_Statement.html">For Each Statement</a></li>
<li><a href="Return_Statement.html">Return Statement</a></li>
<li><a href="While_Statement.html">While Statement</a></li>
</ul>
</main>
<script src="common.js"></script>
<script src="prism.js"></script>
</body>
</html>
