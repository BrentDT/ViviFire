<!DOCTYPE HTML>
<html lang="en-US" dir="ltr">
<head>
<meta charset="utf-8">
<title>For Each Statement - The ViviFire Programming Language</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="common.css" type="text/css">
<link rel="canonical" href="https://www.b6sw.com/ViviFire/docs/For_Each_Statement.html">
<link rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/">
<meta name="author" content="Brent Thorn, https://github.com/brentdt">
</head>
<body>
<nav class="breadcrumb" aria-labelledby="breadcrumbs">
<p id="breadcrumbs">Breadcrumbs</p>
<ul>
<li><a href="http://vivifire.com/">Home</a></li>
<li><a href="ViviFire_Manual.html">ViviFire Manual</a></li>
<li><a rel="section" href="Language_Reference.html">Language Reference</a></li>
<li><a href="Statements_Reference.html">Statements</a></li>
<li><a rel="parent" href="Statements_2.html">E&ndash;P Statements</a></li>
</ul>
</nav>
<main>
<h1 id="top"><code>For Each</code> Statement</h1>
<p>Runs a sequence of statements for each item in a data structure.</p>
<h2>Syntax</h2>
<div class="language-vivifire syntax">
<pre><code >For Each element [ As type ] In group
    [ statements ]
End [ For ]&#10;</code></pre>
</div>
<h2>Parts</h2>
<dl class="parts">
<dt><code class="id">element</code></dt>
<dd>Mandatory variable name declaration.</dd>
<dt><code class="id">type</code></dt>
<dd>Usually optional data type of <code class="id">element</code>.</dd>
<dd>Mandatory if <code class="id">group</code> is an array literal between braces (<code class="op">{ }</code>) and <code class="id">element</code> is without a type character.</dd>
<dt><code class="id">group</code></dt>
<dd>Mandatory collection object, string expression, or array literal.</dd>
<dt><code class="id">statements</code></dt>
<dd>Optional One or more statements between the lines that start with <code class="kw">For Each</code> and <code class="kw">End</code>.
These run one time for each item in a collection.</dd>
<dd>The alternative is two or more groups of statements.
The initial group starts with <code class="kw">Exit When</code>, and runs the same as given above.
The subsequent groups start with <code class="kw">When</code>, and run when (1) the loop cannot start, or (2) after the loop stops.
See <a href="#When_statements">&sect;&nbsp;When statements</a> for more information.</dd>
<dt><code class="kw">End</code></dt>
<dd>Completes the statement.
You can also use <code class="kw">End For</code>.</dd>
<dd>You can change the syntax of this part.
See <a href="Option_Directive.html">@Option Directive</a> for more information.</dd>
</dl>
<h2>Instructions</h2>
<p><code class="kw">End For</code> is not the same as <a href="Exit_Statement.html"><code>Exit For</code></a>.</p>
<p>Use the construct <code class="kw">For Each</code> when you must run one or more statements again and again.
It is recommended when you must run statements for each item in a collection.
Other loop constructs are possibly more flexible.
See the <a href="#See_also">See also</a> section below for more information.</p>
<h2>Usual operation</h2>
<p>TODO</p>
<h3>Loop-index counter</h3>
<p>With loops of this type, you can use a magic integer constant <code>%INDEX</code>.
 It starts at zero (0) and increases by one (1) with each iteration.</p>
 <p>If you nest loops of this type, <code>%INDEX</code> can refer to a different loop to what you think.
 Thus, we recommend that you make special counter variables as an alternative, if necessary.</p>
<h2><code>Exit For</code></h2>
<p>The statement <code class="kw">Exit For</code> can stop this type of loop.
<code class="kw">Exit For</code> immediately runs the statement after <code class="kw">End</code>.</p>
<p><code class="kw">Exit</code> can also stop more than one nested loop.
You can use the statement &laquo;<code class="kw">Exit For, For</code>&raquo; in the inner loop to stop two loops.</p>
<h2 id="When_statements"><code>When</code> statements</h2>
<p>To find if a loop of this type completed because it went through all of the items, use <code>When DONE</code>.
To find if a loop of this type did not run because <code class="id">group</code> is null or empty, use <code>When NONE</code>.
See <a href="Exit_When_Clause.html">Exit When Clause</a> for more information.</p>
<h2>Examples</h2>
<h3>Elements in an array literal</h3>
<div class="language-vivifire listing">
<pre><code>For Each day As String In { "Mon", "Tue", "Wed", "Thu", "Fri" }
    ' do something
End For&#10;</code></pre>
</div>
<h3>Characters in a string</h3>
<div class="language-vivifire listing">
<pre><code>Var s = "ViviFire"
For Each c As Char In s
    ' do something
End For&#10;</code></pre>
</div>
<h2 id="See_also">See also</h2>
<ul class="articles">
<li><a href="Do_Loop_Statement.html">Doo...Loop Statement</a> &ndash; runs code given a pre-condition or a post-condition.</li>
<li><a href="For_Statement.html">For Statement</a> &ndash; Runs through a range of values.</li>
<li><a href="While_Statement.html">While Statement</a> &ndash; Runs code given a pre-condition.</li>
<li><a href="Yield_Statement.html">Yield Statement</a></li>
<li><a href="Iterator.html">@Iterator</a></li>
<li><a href="Iterators.html">Iterators</a></li>
<li><a href="Exit_Statement.html">Exit Statement</a></li>
<li><a href="Exit_When_Clause.html">Exit When Clause</a></li>
<li><a href="Loop_Constructs.html">Loop Constructs</a></li>
<li><a href="Option_Directive.html">@Option Directive</a></li>
</ul>
</main>
<script src="common.js"></script>
<script src="prism.js"></script>
</body>
</html>
