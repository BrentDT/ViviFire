<!DOCTYPE HTML>
<html lang="en-US" dir="ltr">
<head>
<meta charset="utf-8">
<title>@Option Directive - The ViviFire Programming Language</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="common.css" type="text/css">
<link rel="canonical" href="https://www.b6sw.com/ViviFire/docs/Option_Directive.html">
<link rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/">
<meta name="author" content="Brent Thorn, https://github.com/brentdt">
</head>
<body>
<nav class="breadcrumb" aria-labelledby="breadcrumbs">
<p id="breadcrumbs">Breadcrumbs</p>
<ul>
<li><a href="http://vivifire.com/">Home</a></li>
<li><a href="ViviFire_Manual.html">ViviFire Manual</a></li>
<li><a rel="section" href="Language_Reference.html">Language Reference</a></li>
<li><a rel="parent" href="Directives.html">Directives</a></li>
</ul>
</nav>
<main>
<h1 id="top"><code>@Option</code> Directive</h1>
<p>Makes sure that your code agrees with a given style or syntax.
And also lets you change how some functions operate.</p>
<h2>Syntax</h2>
<div class="language-vivifire syntax">
<pre><code>@Option options&hellip;&#10;</code></pre>
</div>
<h2>Parts</h2>
<dl class="parts">
<dt><code>options</code></dt>
<dd>Mandatory one or more identifiers</dd>
</dl>
<h2>Instructions</h2>
<nav aria-labelledby="toc">
<details open>
<summary id="toc">Table of contents</summary>
<ol class="notranslate" style="display: inline-block; columns: 2">
<li><a href="#Args">Args</a></li>
<li><a href="#Charset">Charset</a></li>
<li><a href="#Dim">Dim</a></li>
<li><a href="#End">End</a></li>
<li><a href="#Enum">Enum</a></li>
<li><a href="#If">If</a></li>
<li><a href="#Last">Last</a></li>
<li><a href="#Mod">Mod</a></li>
<li><a href="#New">New</a></li>
<li><a href="#Optional">Optional</a></li>
<li><a href="#Select">Select</a></li>
<li><a href="#String">String</a></li>
<li><a href="#Test">Test</a></li>
<li><a href="#Unit">Unit</a></li>
<li><a href="#Warning">Warning</a></li>
<li><a href="#When">When</a></li>
</ol>
</details>
</nav>
<h3 id="Args" class="notranslate">Args</h3>
<h4><code>@Option Args ByName { Boolean | Literal }</code></h4>
<p>Procedure calls that have one or more Booleans or literals for arguments can show a warning if not passed by name.
The warning is applicable only if you supply two or more such arguments to the procedure.
The warning has a level of <code>Warning4</code>.</p>
<p>See <a href="Passing_Arguments_Position_Name.html">Passing Arguments by Position and by Name</a> for more information.</p>
<h4><code>@Option Args Enclosed</code></h4>
<p>You must write parentheses (<code class="op">( )</code>) around (1) arguments for procedure calls and (2) parameters for procedure declarations.
Procedure declarations start with one of these keywords: <span class="kws"><code>Function</code>, <code>Method</code>, or <code>Sub</code></span>.
You must supply empty parentheses if a procedure has no parameters.
And if a procedure call does not have arguments, you must write empty parentheses or a question mark (<code class="op">?</code>).</p>
<h3 id="Charset" class="notranslate">Charset</h3>
<h4><code>@Option charset Latin</code></h4>
<p>All names must use the Latin character set.
That is letters (&lsquo;A&rsquo; thru &lsquo;Z&rsquo;), digits (&lsquo;0&rsquo; thru &lsquo;9&rsquo;), and underscores (&lsquo;_&rsquo;).</p>
<h3 id="Dim" class="notranslate">Dim</h3>
<h4><code>@Option Dim</code></h4>
<p>You must start a variable declaration with <code class="kw">Dim</code>, and not <code class="kw">Var</code>.
For example:</p>
<div class="language-vivifire listing">
<pre><code>Dim x As Int32&#10;</code></pre>
</div>
<h4><code>@Option Var</code></h4>
<p>You must start a variable declaration with <code class="kw">Var</code>, and not <code class="kw">Dim</code>.
For example:</p>
<div class="language-vivifire listing">
<pre><code>Var x As Int32&#10;</code></pre>
</div>
<h3 id="End" class="notranslate">End</h3>
<h4><code>@Option End Block</code></h4>
<p>You must write <code class="kw">End</code> plus the block type.
For example:</p>
<div class="language-vivifire listing">
<pre><code>While condition
  ' ...
End While&#10;</code></pre>
</div>
<h4><code>@Option End [ No Block ]</code></h4>
<p>You must write <code class="kw">End</code> without the block type.
For example:</p>
<div class="language-vivifire listing">
<pre><code>While condition
  ' ...
End&#10;</code></pre>
</div>
<h4><code>@Option End For ID</code></h4>
<p>You can use this only with &ldquo;<code>@Option End Block</code>&rdquo;.
You must complete all statements of the type <code class="kw">For</code>with <code class="kw">End For</code>, plus the loop counter.
For example:</p>
<div class="language-vivifire listing">
<pre><code>For index = 1 To 10
  ' ...
End For index&#10;</code></pre>
</div>
<h4><code>@Option End For [ No ID ]</code></h4>
<p>You can use this only with &ldquo;<code>@Option End Block</code>&rdquo;.
You must complete all statements of the type <code class="kw">For</code> with <code class="kw">End For</code>, without the loop counter.
For example:</p>
<div class="language-vivifire listing">
<pre><code>For index = 1 To 10
  ' ...
End For&#10;</code></pre>
</div>
<h3 id="Enum" class="notranslate">Enum</h3>
<h4><code>@Option Enum ID</code></h4>
<p>You must give a name to all statements of the type <code class="kw">Enum</code>.
For example:</p>
<div class="language-vivifire listing">
<pre><code>Enum DogBreed
  ' ...
End&#10;</code></pre>
</div>
<h4><code>@Option Enum Is</code></h4>
<p>You must give statements of the type <code class="kw">Enum</code> a data type, with the clause <code class="kw">Is</code>.
For example:</p>
<div class="language-vivifire listing">
<pre><code>Enum Is UInt16
  ' ...
End&#10;</code></pre>
</div>
<h4><code>@Option Enum Equals</code></h4>
<p>You must give members of the statement <code class="kw">Enum</code> values, assigned with the operator &ldquo;<code class="op">=</code>&rdquo;.
For example:</p>
<div class="language-vivifire listing">
<pre><code>Enum
  first  = 1
  second = 2
End&#10;</code></pre>
</div>
<h3 id="If" class="notranslate">If</h3>
<h4><code>@Option If Then</code></h4>
<p>You must write <code class="kw">Then</code> with all statements of the type <code class="kw">If&hellip;Else</code>.
For example:</p>
<div class="language-vivifire listing">
<pre><code>If condition1 Then
  ' ...
Else If condition2 Then
  ' ...
End&#10;</code></pre>
</div>
<h4><code>@Option If [ No Then ]</code></h4>
<p>You must not write <code class="kw">Then</code> with the block construct of the statement <code class="kw">If&hellip;Else</code>.
For example:</p>
<div class="language-vivifire listing">
<pre><code>If condition1
  ' ...
Else If condition2
  ' ...
End&#10;</code></pre>
</div>
<h4><code>@Option If End</code></h4>
<p>You must complete statements of the type <code class="kw">If&hellip;Else</code> with <code class="kw">End</code> or <code class="kw">End If</code>.
If you use &ldquo;<code>@Option End Block</code>&rdquo;, you must write <code class="kw">End If</code>.
Thus, use of the one-line construct becomes an error.</p>
<h3 id="Last" class="notranslate">Last</h3>
<h4><code>@Option Last</code></h4>
<p>No more directives of the type <code class="at">@Option</code> are permitted after this one.</p>
<h3 id="Mod" class="notranslate">Mod</h3>
<h4><code>@Option Mod Floored</code></h4>
<p>Changes how the operators <code class="kw">Mod</code> and <code class="op">Mod=</code> operate.
Usually the two operators <code class="kw">Mod</code> and <code class="kw">Rem</code> operate the same.
They return the remainder after division.</p>
<p>Usually the sign of the remainder comes from the left side, or <dfn>dividend</dfn>.
This type of operation is known as <dfn>truncated modulo</dfn>.
But this directive causes the sign of the remainder to come from the right side, or <dfn>divisor</dfn>.
This alternative operation is known as <dfn>floored modulo</dfn>.</p>
<table class="language-vivifire">
<caption>Mod results</caption>
<thead>
<tr><th>Example</th><th>Truncated</th><th>Floored</th></tr>
</thead>
<tbody>
<tr><td><code>+9 Mod +4</code></td>
	<td><samp>&nbsp;1</samp></td>
	<td><samp>&nbsp;1</samp></td></tr>
<tr><td><code>-9 Mod +4</code></td>
	<td><samp>-1</samp></td>
	<td><samp>&nbsp;1</samp></td></tr>
<tr><td><code>+9 Mod -4</code></td>
	<td><samp>&nbsp;1</samp></td>
	<td><samp>-1</samp></td></tr>
<tr><td><code>-9 Mod -4</code></td>
	<td><samp>-1</samp></td>
	<td><samp>-1</samp></td></tr>
</tbody>
</table>
<h3 id="New" class="notranslate">New</h3>
<h4><code>@Option New</code></h4>
<p>You must start <code class="kw">New</code> Statements with <code class="kw">New</code>.
If you use &ldquo;<code>@Option End Block</code>&rdquo;, you must complete the block construct with <code class="kw">End New</code>.
For example:</p>
<div class="language-vivifire listing">
<pre><code>New Files #logs, "*.log"

New Menu #file, "File"
Begin
  ' ...
End New&#10;</code></pre>
</div>
<h3 id="Optional" class="notranslate">Optional</h3>
<h4><code>@Option Optional Equals</code></h4>
<p>You must give a value to an optional parameter with the operator &ldquo;<code class="op">=</code>&rdquo;.
For example:</p>
<div class="language-vivifire listing">
<pre><code>Method ReadData(Optional path As String = ".")
  ' ...
End&#10;</code></pre>
</div>
<h3 id="Select" class="notranslate">Select</h3>
<h4><code>@Option Select Case</code></h4>
<p>You must write <code class="kw">Select Case</code> in all statements of the type <code class="kw">Select&hellip;Case</code>.
For example:</p>
<div class="language-vivifire listing">
<pre><code>Select Case test
  ' ...
End&#10;</code></pre>
</div>
<h4><code>@Option Select [ No Case ]</code></h4>
<p>You must not write the keyword <code class="kw">Case</code> after <code class="kw">Select</code> in all statements of the type <code class="kw">Select&hellip;Case</code>.</p>
<h4><code>@Option Select Strict</code></h4>
<p>You must do something for all possible values of the test expressions of statements of the type <code class="kw">select&hellip;Case</code>.
You can try to supply a sufficient number of values with the clause <code class="kw">Case</code>.
But if that is not possible, you must supply the clause <code class="kw">Case Else</code>.
This is the same as if you used the modifier <code class="at">@Strict</code> with all such statements.
For example:</p>
<div class="language-vivifire listing">
<pre><code>Select minutes
Case 0 To 29
  ' ...
Case 30 To 59
  ' ...
Case Else
  Raise RangeError(minutes)
End&#10;</code></pre>
</div>
<h4><code>@Option Select Strict String</code></h4>
<p>You must write the clause &ldquo;<code class="kw">Case Else</code>&rdquo; for all statements of the type <code class="kw">Select&hellip;Case</code> that compare strings.
But <code class="kw">Case Else</code> will not be mandatory for other data types.</p>
<h3 id="String" class="notranslate">String</h3>
<h4><code>@Option String Backslash</code></h4>
<p>You must write a path string with backslashes, not slashes.
For example:</p>
<div class="language-vivifire listing">
<pre><code>Const BITMAP_DIR = &quot;media&quot;\&quot;bmp&quot;&#10;</code></pre>
</div>
<h4><code>@Option String Slash</code></h4>
<p>You must write a path string with slashes, not backslashes.
For example:</p>
<div class="language-vivifire listing">
<pre><code>Const BITMAP_DIR = &quot;media&quot;/&quot;bmp&quot;&#10;</code></pre>
</div>
<h3 id="Test" class="notranslate">Test</h3>
<h4><code>@Option Test</code></h4>
<p>Causes ViviFire to parse inline comments to find commands used in tests of the compiler.
You must not use this directive unless you do work on the compiler.
Block comments are ignored as usual.</p>
<p>These commands (<code>expect-error</code> and <code>expect-warning</code>) cause the compiler to ignore errors and warnings before the applicable command.
The comment must be on the same line as the statement, or the line immediately after the statement.</p>
<p>Then you must write the error or warning message between a pair of two braces (<code class="op">{{ }}</code>).
The compiler ignores the remaining comment until the end of the line.</p>
<p>An example follows.</p>
<div class="language-vivifire listing">
<pre><code>@Option Test
Program MyProgram

x = 1 // expect-error {{Variable was not declared}} TBD

Const _BAD_NAME = "The user name is not valid."
    ' expect-error {{Invalid Name}}&#10;</code></pre>
</div>
<h3 id="Unit" class="notranslate">Unit</h3>
<h4><code>@Option Unit Full</code></h4>
<p>You must write the full names of units of measure.
Thus &ldquo;kilometer&rdquo; is correct syntax, but &ldquo;km&rdquo; is incorrect.</p>
<h3 id="Warning" class="notranslate">Warning</h3>
<h4><code>@Option Warning[1-5]</code></h4>
<table>
<caption>Warning levels</caption>
<thead>
<tr><th>Option</th>
<th>ViviFire shows</th></tr>
</thead>
<tbody>
<tr><td><code>Warning1</code></td>
<td>Only warnings with a risk <strong>more than 75%</strong> to cause problems</td></tr>
<tr><td><code>Warning2</code></td>
<td>Only warnings with a risk <strong>more than 50%</strong> to cause problems</td></tr>
<tr><td><code>Warning3</code></td>
<td>Only warnings with a risk <strong>more than 25%</strong> to cause problems</td></tr>
<tr><td><code>Warning4</code> or <code>Warning</code></td>
<td>Only warnings with a risk <strong>more than 0%</strong> to cause problems (<strong>Default</strong>)</td></tr>
<tr><td><code>Warning5</code></td>
<td><strong>All warnings</strong>, if they cause problems or not.</td></tr>
</tbody>
</table>
<h4><code>@Option Warning[1-5] Error</code></h4>
<p>When you add <code>Error</code>, all warnings at that level and below become errors.
You can use the two syntaxes together if the level for errors is less than the level for warnings.
An example follows.</p>
<div class="language-vivifire listing">
<pre><code>@Option Warning1 Error
@Option Warning5&#10;</code></pre>
</div>
<h3 id="When" class="notranslate">When</h3>
<h4><code>@Option When Each</code></h4>
<p>You must write <code class="kw">When Each</code>, and not <code class="kw">When Else</code>, for statements of the type <code class="kw">Begin&hellip;When</code>.
For example:</p>
<div class="language-vivifire listing">
<pre><code>While condition
Begin
    ' ...
When Each
    ' ...
End&#10;</code></pre>
</div>
<h4><code>@Option When Else</code></h4>
<p>You must write <code class="kw">When Else</code>, and not <code class="kw">When Each</code>, for statements of the type <code class="kw">Begin&hellip;When</code>.
For example:</p>
<div class="language-vivifire listing">
<pre><code>While condition
Begin
    ' ...
When Else
    ' ...
End&#10;</code></pre>
</div>
<h4><code>@Option When Begin ID</code></h4>
<p>You must write all the labels that are after each <code class="kw">When</code> (in a loop) also after <code class="kw">Begin</code>.
Thus it becomes an error not to supply this list.
For example:</p>
<div class="language-vivifire listing">
<pre><code>While NextResult?
Begin found ' mandatory
    ' ...
When found
    ' ...
End&#10;</code></pre>
</div>
<h2>See also</h2>
<ul class="articles" style="display: inline-block; columns: 2">
<li><a href="Begin_When_Statements.html">Begin&hellip;When Statements</a></li>
<li><a href="Constructor_Statement.html">Constructor Statement</a></li>
<li><a href="Dim_Statement.html">Dim Statement</a></li>
<li><a href="Enum_Statement.html">Enum Statement</a></li>
<li><a href="For_Each_In_Statement.html">For Each Statement</a></li>
<li><a href="For_To_Statement.html">For Statement</a></li>
<li><a href="If_Then_Else_Statement.html">If&hellip;Else Statement</a></li>
<li><a href="Mod_Operator.html">Mod Operator</a></li>
<li><a href="Mod_Equals_Operator.html">Mod= Operator</a></li>
<li><a href="New_Statement.html">New Statement</a></li>
<li><a href="Optional.html">Optional</a></li>
<li><a href="Select_Case_Statement.html">Select&hellip;Case Statement</a></li>
<li><a href="String_Data_Type.html">String Data Type</a></li>
<li><a href="Error_and_Warn_Directives.html">@Error and @Warn Directives</a></li>
</ul>
</main>
<script src="common.js"></script>
<script src="prism.js"></script>
</body>
</html>
